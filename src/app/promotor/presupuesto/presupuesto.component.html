<p-toast></p-toast>
<section>
    <div class="grid text-center">
        <div class="col-4">
            <div>Descripción del equipo…</div>
            <p-autoComplete inputStyleClass="p-inputtext-sm" styleClass="p-inputtext-sm w-full my-2"
                [suggestions]="items" [ngModel]="binding.nombre" (completeMethod)="filterItems($event)" [dropdown]="true"
                (onSelect)="productoselect($event)">
            </p-autoComplete>
        </div>
        <div class="col-3">
            <div>Marca</div>
            <input type="text" [ngModel]="binding.marca" [disabled]="true"
                class="p-inputtext-sm w-full my-2 text-center" pInputText />
        </div>
        <div class="col-3">
            <div>Serie</div>
            <input type="text" [ngModel]="binding.serie" [disabled]="true"
                class="p-inputtext-sm w-full my-2 text-center" pInputText />
        </div>
        <div class="col-2">
            <div>Modelo</div>
            <input type="text" [ngModel]="binding.modelo" [disabled]="true"
                class="p-inputtext-sm w-full my-2 text-center" pInputText />
        </div>
    </div>
    <div class="grid text-center">
        <div class="col-4">
            <div>Precio de Lista (moneda de origen);</div>
            <p-inputNumber class="w-full" [(ngModel)]="binding.precio" (onBlur)="preciocambio()" [minFractionDigits]="2"
                mode="currency" currency="USD" locale="en-US"
                styleClass="p-inputtext-sm w-full my-2 text-center"></p-inputNumber>
        </div>
        <div class="col-4">
            <div>Moneda</div>
            <input type="text" [disabled]="true" [ngModel]="monedas" class="p-inputtext-sm w-full my-2 text-center"
                pInputText />
        </div>
        <div *ngIf="binding.moneda==20" class="col-4">
            <div>Tipo Cambio</div>
            <p-inputNumber class="w-full" [(ngModel)]="peso_valor" (onBlur)="preciocambio()" [minFractionDigits]="2"
                mode="currency" currency="USD" locale="en-US"
                styleClass="p-inputtext-sm w-full my-2 text-center"></p-inputNumber>
        </div>
    </div>
    <form [formGroup]="presupuestoForm">
        <div class="grid mt-2">
            <div class="col-6">
                <div class="grid">
                    <div class="col-5 align-self-center p-0 text-center">
                        Precio de Venta en pe$os;
                    </div>
                    <div class="col-7 p-1 align-self-center">
                        <p-inputNumber class="w-full" formControlName="precio_venta" [minFractionDigits]="2"
                            mode="currency" currency="USD" locale="en-US"
                            styleClass="p-inputtext-sm w-full text-center"></p-inputNumber>
                    </div>
                    <div *ngIf="binding.apply_iva==10 || binding.apply_iva==0" class="col-5 align-self-center p-0 text-center">
                        IVA;
                    </div>
                    <div *ngIf="binding.apply_iva==10 || binding.apply_iva==0" class="col-7 p-1 align-self-center">
                        <p-inputNumber class="w-full" formControlName="iva" [minFractionDigits]="2" mode="currency"
                            currency="USD" locale="en-US"
                            styleClass="p-inputtext-sm w-full text-center"></p-inputNumber>
                    </div>
                    <div class="col-5 align-self-center p-0 text-center">
                        Núm. Unidades;
                    </div>
                    <div class="col-7 p-1 align-self-center">
                        <p-inputNumber class="w-full" formControlName="cantidad" [min]="1"
                            styleClass="p-inputtext-sm w-full text-center" (onBlur)="elsubtotal()"></p-inputNumber>
                    </div>
                    <div class="col-5 align-self-center p-0 text-center">
                        Cotización Total;
                    </div>
                    <div class="col-7 p-1 align-self-center">
                        <p-inputNumber class="w-full" formControlName="cotizacion" [minFractionDigits]="2"
                            mode="currency" currency="USD" locale="en-US"
                            styleClass="p-inputtext-sm w-full text-center"></p-inputNumber>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="grid">
                    <div class="col-5 align-self-center p-1 text-center">
                        Comisión por apertura del Crédito (incluye IVA) >
                    </div>
                    <div class="col-7 p-1 align-self-center">
                        <div class="grid">
                            <div class="col-2">
                                <p-inputNumber inputStyleClass="w-3rem" suffix="%"
                                    styleClass="p-inputtext-sm text-center" (onBlur)="otromas()"
                                    formControlName="comision_apertura_porcentaje"></p-inputNumber>
                            </div>
                            <div class="col-10">
                                <p-inputNumber class="w-full" formControlName="comision_apertura"
                                    [minFractionDigits]="2"  mode="currency" currency="MXN" locale="es-MX"
                                    styleClass="p-inputtext-sm w-full text-center"></p-inputNumber>
                            </div>
                        </div>
                    </div>
                    <div class="col-5 align-self-center p-0 text-center">
                        Seguro del Equipo (incluye IVA) >
                    </div>
                    <div class="col-7 p-1 align-self-center">
                        <p-inputNumber class="w-full" formControlName="seguro_equipo" (onBlur)="otromas()"
                            [minFractionDigits]="2" mode="currency" currency="USD" locale="en-US"
                            styleClass="p-inputtext-sm w-full text-center"></p-inputNumber>
                    </div>
                    <div class="col-5 align-self-center p-0 text-center">
                        INVERSION TOTAL (pesos) >
                    </div>
                    <div class="col-7 p-1 align-self-center">
                        <p-inputNumber class="w-full" formControlName="inversion_total" [minFractionDigits]="2"
                            mode="currency" currency="USD" locale="en-US"
                            styleClass="p-inputtext-sm w-full text-center"></p-inputNumber>
                    </div>
                    <div class="col-5 align-self-center p-0 text-center">
                        Descuentos;
                    </div>
                    <div class="col-7 p-1 align-self-center">
                        <p-inputNumber class="w-full" formControlName="descuento_valor" [minFractionDigits]="2"
                            mode="currency" currency="USD" locale="en-US" (onBlur)="cambiodescuento()"
                            styleClass="p-inputtext-sm w-full text-center"></p-inputNumber>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <div class="grid mt-2">
            <div class="col-4"></div>
            <div class="col-8">
                <div class="grid">
                    <div class="col-6 align-self-center p-0 text-right">
                        Importe Final;
                    </div>
                    <div class="col-6 p-1 align-self-center">
                        <p-inputNumber class="w-full" formControlName="importe_final"  [minFractionDigits]="2"
                            mode="currency" currency="USD" locale="en-US"
                            styleClass="p-inputtext-sm w-full text-center"></p-inputNumber>
                    </div>
                    <div class="col-6 align-self-center p-0 text-right">
                        Aportación del productor (incluye enganche);
                    </div>
                    <div class="col-6 p-1 align-self-center">
                        <div class="grid">
                            <div class="col-2">
                                <p-inputNumber inputStyleClass="w-4rem" suffix="%"
                                    formControlName="aportacion_producto_porcentaje" [min]="20" (onBlur)="otromas()"
                                    styleClass="p-inputtext-sm text-center"></p-inputNumber>
                            </div>
                            <div class="col-10">
                                <p-inputNumber class="w-full" formControlName="aportacion_producto_valor"
                                    (onBlur)="alrevez()" [minFractionDigits]="2" mode="currency" currency="USD"
                                    locale="en-US" styleClass="p-inputtext-sm w-full text-center"></p-inputNumber>
                            </div>
                        </div>
                    </div>
                    <div class="col-6 align-self-center p-0 text-right">
                        Importe a Financiamiento (pesos);
                    </div>
                    <div class="col-6 p-1 align-self-center">
                        <div class="grid">
                            <div class="col-2">
                                <p-inputNumber inputStyleClass="w-4rem" suffix="%"
                                    styleClass="p-inputtext-sm text-center"
                                    formControlName="importe_financiamiento_porcentaje"></p-inputNumber>
                            </div>
                            <div class="col-10">
                                <p-inputNumber class="w-full" [minFractionDigits]="2" mode="currency" currency="USD"
                                    locale="en-US" formControlName="importe_financiamiento_valor"
                                    styleClass="p-inputtext-sm w-full text-center"></p-inputNumber>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="estatus_solicitud==2 || estatus_solicitud==0" class="flex align-items-center justify-content-between">
            <button pButton label="Anterior" routerLink="/promotor/originacion/informacion" class="mt-3 bg-primary-700"></button>
            <button pButton label="Guardar y Salir" (click)="guardasale()" class="mt-3 mr-3 bg-yellow-500"></button>
            <button pButton (click)="resultados()" label="Guardar y Continuar" class="mt-3 bg-red-700"></button>
         </div>
    </form>
</section>